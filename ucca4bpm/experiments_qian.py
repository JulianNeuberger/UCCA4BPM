from tensorflow.keras.optimizers import Adam

from ucca4bpm.models.train import run
from ucca4bpm.util.visualization import plot_f1_metrics

experiment_name = f'our_approach_qian_data'
num_folds = 5
span_matching_modes = {'exact': 'F1 Exact', 'fragment': 'F1 Fragment'}
plot_f1_metrics([
    run(run_name='SC_COR',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/qian_sc_cor_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=1,
        optimizer=Adam(lr=5e-4),
        early_stopping=False,
        num_gcn_hidden_layers=2,
        none_class_id=None,
        num_folds=num_folds),
    run(run_name='SC_MAM',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/qian_sc_mam_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=1,
        optimizer=Adam(lr=5e-4),
        early_stopping=False,
        num_gcn_hidden_layers=2,
        none_class_id=None,
        num_folds=num_folds),

    run(run_name='SSR_COR',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/qian_ssr_cor_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=2,
        optimizer=Adam(lr=5e-5),
        early_stopping=False,
        none_class_id=None,
        num_gcn_hidden_layers=4,
        num_folds=num_folds),
    run(run_name='SSR_MAM',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/qian_ssr_mam_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=2,
        optimizer=Adam(lr=5e-5),
        early_stopping=False,
        num_gcn_hidden_layers=4,
        none_class_id=None,
        num_folds=num_folds),

    run(run_name='SRL_COR',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/qian_srl_cor_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=2,
        optimizer=Adam(lr=5e-5),
        early_stopping=False,
        num_gcn_hidden_layers=4,
        none_class_id=None,
        num_folds=num_folds),
    run(run_name='SRL_MAM',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/qian_srl_mam_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=2,
        optimizer=Adam(lr=5e-5),
        early_stopping=False,
        num_gcn_hidden_layers=4,
        none_class_id=None,
        num_folds=num_folds),

    run(run_name='ours_sc',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/ours_qian_sc_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=10,
        optimizer=Adam(lr=5e-4),
        early_stopping=False,
        num_gcn_hidden_layers=2,
        none_class_id=None,
        num_folds=num_folds),
    run(run_name='ours_ssr',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/ours_qian_ssr_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=15,
        optimizer=Adam(lr=5e-4),
        early_stopping=False,
        num_gcn_hidden_layers=2,
        none_class_id=None,
        num_folds=num_folds),
    run(run_name='ours_srl',
        experiment_name=experiment_name,
        data_set_path='ucca4bpm/data/transformed/ours_qian_srl_postags_fine.pickle',
        span_matching_modes=list(span_matching_modes.keys()),
        gcn_hidden_len=64,
        num_epochs=20,
        optimizer=Adam(lr=5e-4),
        early_stopping=False,
        num_gcn_hidden_layers=2,
        none_class_id=None,
        num_folds=num_folds)
], 'Our approach on data by Qian et al', {f'f1_{mode}': label for mode, label in span_matching_modes.items()})
